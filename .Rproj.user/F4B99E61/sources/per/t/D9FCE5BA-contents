## generate variables to account for other features of the cars in 'снаружи', 
# опции автомобиля', оптика, салон  and медиа

## снаружи
result$снаружи <- tolower(result$снаружи)

words_snaruji <- unlist(strsplit(result$снаружи, ","))
word_counts_snaruji <- table(words_snaruji)
print(word_counts_snaruji)

result$vetrovik <- ifelse(grepl("ветровики", result$снаружи, ignore.case = TRUE), 1, NA)
result$vetrovik[is.na(result$vetrovik)] <- 0
#View(result[, c("vetrovik", "снаружи")])

result$litium_discs <- ifelse(grepl("литые диски", result$снаружи, ignore.case = TRUE), 1, NA)
result$litium_discs[is.na(result$litium_discs)] <- 0

result$kenguryatnik <- ifelse(grepl("Кенгурятник", result$снаружи, ignore.case = TRUE), 1, NA)
result$kenguryatnik[is.na(result$kenguryatnik)] <- 0

result$lyuk <- ifelse(grepl("люк|панорамная", result$снаружи, ignore.case = TRUE), 1, NA)
result$lyuk[is.na(result$lyuk)] <- 0

result$lebedka <- ifelse(grepl("лебёдка", result$снаружи, ignore.case = TRUE), 1, NA)
result$lebedka[is.na(result$lebedka)] <- 0

result$obves <- ifelse(grepl("обвес", result$снаружи, ignore.case = TRUE), 1, NA)
result$obves[is.na(result$obves)] <- 0

result$reyling <- ifelse(grepl("рейлинги", result$снаружи, ignore.case = TRUE), 1, NA)
result$reyling[is.na(result$reyling)] <- 0

result$spoyler <- ifelse(grepl("спойлер", result$снаружи, ignore.case = TRUE), 1, NA)
result$spoyler[is.na(result$spoyler)] <- 0

result$tonirovka <- ifelse(grepl("тонировка", result$снаружи, ignore.case = TRUE), 1, NA)
result$tonirovka[is.na(result$tonirovka)] <- 0

result$farkop <- ifelse(grepl("фаркоп", result$снаружи, ignore.case = TRUE), 1, NA)
result$farkop[is.na(result$farkop)] <- 0



## опции автомобиля
result$`опции автомобиля` <- tolower(result$`опции автомобиля`)

words_options <- unlist(strsplit(result$`опции автомобиля`, ","))
word_counts_options <- table(words_options)
print(word_counts_options)

result$abs <- ifelse(grepl("abs", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$abs[is.na(result$abs)] <- 0

result$автозапуск <- ifelse(grepl("автозапуск", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$автозапуск[is.na(result$автозапуск)] <- 0

result$бесключевой_доступ <- ifelse(grepl("бесключевой доступ", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$бесключевой_доступ[is.na(result$бесключевой_доступ)] <- 0

result$бортовой_компьютер  <- ifelse(grepl("бортовой компьютер", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$бортовой_компьютер [is.na(result$бортовой_компьютер)] <- 0

result$вентиляция_сидений <- ifelse(grepl("вентиляция сидений", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$вентиляция_сидений[is.na(result$вентиляция_сидений)] <- 0

result$гидравлика_руля <- ifelse(grepl("гидравлика руля", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$гидравлика_руля[is.na(result$гидравлика_руля)] <- 0

result$датчик_давления_шинах <- ifelse(grepl("датчик давления в шинах", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$датчик_давления_шинах[is.na(result$датчик_давления_шинах)] <- 0

result$датчик_дождя <- ifelse(grepl("датчик дождя", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$датчик_дождя[is.na(result$датчик_дождя)] <- 0

result$датчик_света <- ifelse(grepl("датчик света", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$датчик_света[is.na(result$датчик_света)] <- 0

result$зимний_режим <- ifelse(grepl("зимний режим", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$зимний_режим[is.na(result$зимний_режим)] <- 0

result$изменяемый_клиренс <- ifelse(grepl("изменяемый клиренс", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$изменяемый_клиренс[is.na(result$изменяемый_клиренс)] <- 0

result$камера_заднего_вида <- ifelse(grepl("камера заднего вида", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$камера_заднего_вида[is.na(result$камера_заднего_вида)] <- 0

result$климат_контроль <- ifelse(grepl("климат-контроль", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$климат_контроль[is.na(result$климат_контроль)] <- 0

result$кондиционер <- ifelse(grepl("кондиционер", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$кондиционер[is.na(result$кондиционер)] <- 0

result$круиз_контроль <- ifelse(grepl("круиз-контроль", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$круиз_контроль[is.na(result$круиз_контроль)] <- 0

result$мультируль <- ifelse(grepl("мультируль", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$мультируль[is.na(result$мультируль)] <- 0

result$навигационная_система <- ifelse(grepl("навигационная система", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$навигационная_система[is.na(result$навигационная_система)] <- 0

result$мультируль <- ifelse(grepl("мультируль", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$мультируль[is.na(result$мультируль)] <- 0

result$память_руля <- ifelse(grepl("память руля", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$память_руля[is.na(result$память_руля)] <- 0

result$память_сидений <- ifelse(grepl("память сидений", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$память_сидений[is.na(result$память_сидений)] <- 0

result$парктроники <- ifelse(grepl("парктроники", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$парктроники[is.na(result$парктроники)] <- 0

result$мультируль <- ifelse(grepl("мультируль", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$мультируль[is.na(result$мультируль)] <- 0

result$пневмоподвеска <- ifelse(grepl("пневмоподвеска", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$пневмоподвеска[is.na(result$пневмоподвеска)] <- 0

result$подогрев_задних_сидений <- ifelse(grepl("подогрев задних сидений", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$подогрев_задних_сидений[is.na(result$подогрев_задних_сидений)] <- 0

result$подогрев_руля <- ifelse(grepl("подогрев руля", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$подогрев_руля[is.na(result$подогрев_руля)] <- 0

result$подогрев_сидений <- ifelse(grepl("подогрев сидений", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$подогрев_сидений[is.na(result$подогрев_сидений)] <- 0

result$подушка_безопасности <- ifelse(grepl("подушка безопасности", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$подушка_безопасности[is.na(result$подушка_безопасности)] <- 0

result$полный_электропакет <- ifelse(grepl("полный электропакет", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$полный_электропакет[is.na(result$полный_электропакет)] <- 0

result$сигнализация <- ifelse(grepl("сигнализация", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$сигнализация[is.na(result$сигнализация)] <- 0

result$спортивный_режим <- ifelse(grepl("спортивный режим", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$спортивный_режим[is.na(result$спортивный_режим)] <- 0

result$турбонаддув <- ifelse(grepl("турбонаддув", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$турбонаддув[is.na(result$турбонаддув)] <- 0

result$турботаймер <- ifelse(grepl("турботаймер", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$турботаймер[is.na(result$турботаймер)] <- 0

result$центрозамок <- ifelse(grepl("центрозамок", result$`опции автомобиля`, ignore.case = TRUE), 1, NA)
result$центрозамок[is.na(result$центрозамок)] <- 0


## оптика
result$оптика <- tolower(result$оптика)

words_optics <- unlist(strsplit(result$оптика, ","))
word_counts_optics <- table(words_optics)
print(word_counts_optics)

result$ksenon <- ifelse(grepl("биксенон|ксенон", result$оптика, ignore.case = TRUE), 1, NA)
result$ksenon[is.na(result$ksenon)] <- 0
#View(result[, c("ksenon", "оптика")])

result$linsen <- ifelse(grepl("линзованная оптика", result$оптика, ignore.case = TRUE), 1, NA)
result$linsen[is.na(result$linsen)] <- 0

result$window_heating <- ifelse(grepl("обогрев зеркал", result$оптика, ignore.case = TRUE), 1, NA)
result$window_heating[is.na(result$window_heating)] <- 0

result$blinker_washers <- ifelse(grepl("омыватель фар", result$оптика, ignore.case = TRUE), 1, NA)
result$blinker_washers[is.na(result$blinker_washers)] <- 0

result$protivotuman <- ifelse(grepl("противотуманки", result$оптика, ignore.case = TRUE), 1, NA)
result$protivotuman[is.na(result$protivotuman)] <- 0

result$xrustal <- ifelse(grepl("хрустальная оптика", result$оптика, ignore.case = TRUE), 1, NA)
result$xrustal[is.na(result$xrustal)] <- 0

result$ogni <- ifelse(grepl("дневные ходовые огни", result$оптика, ignore.case = TRUE), 1, NA)
result$ogni[is.na(result$ogni)] <- 0

result$light_corrector <- ifelse(grepl("корректор фар", result$оптика, ignore.case = TRUE), 1, NA)
result$light_corrector[is.na(result$light_corrector)] <- 0



## салон
result$салон <- tolower(result$салон)

words_salon <- unlist(strsplit(result$салон, ","))
word_counts_salon <- table(words_salon)
print(word_counts_salon)

result$alcantara <- ifelse(grepl("алькантара", result$салон, ignore.case = TRUE), 1, NA)
result$alcantara[is.na(result$alcantara)] <- 0
#View(result[, c("alcantara", "оптика")])

result$velure <- ifelse(grepl("велюр", result$салон, ignore.case = TRUE), 1, NA)
result$velure[is.na(result$velure)] <- 0

result$wood <- ifelse(grepl("дерево", result$салон, ignore.case = TRUE), 1, NA)
result$wood[is.na(result$wood)] <- 0

result$leather <- ifelse(grepl("кожа", result$салон, ignore.case = TRUE), 1, NA)
result$leather[is.na(result$leather)] <- 0

result$combi <- ifelse(grepl("комбинированный", result$салон, ignore.case = TRUE), 1, NA)
result$combi[is.na(result$combi)] <- 0

result$shtorki <- ifelse(grepl("шторки", result$салон, ignore.case = TRUE), 1, NA)
result$shtorki[is.na(result$shtorki)] <- 0


## медиа
result$медиа <- tolower(result$медиа)

words_media <- unlist(strsplit(result$медиа, ","))
word_counts_media <- table(words_media)
print(word_counts_media)

result$bluetooth <- ifelse(grepl("bluetooth", result$медиа, ignore.case = TRUE), 1, NA)
result$bluetooth[is.na(result$bluetooth)] <- 0

result$disc_reader <- ifelse(grepl("cd|dvd", result$медиа, ignore.case = TRUE), 1, NA)
result$disc_reader[is.na(result$disc_reader)] <- 0

result$audio_system <- ifelse(grepl("аудиосистема", result$медиа, ignore.case = TRUE), 1, NA)
result$audio_system[is.na(result$audio_system)] <- 0

result$mp3 <- ifelse(grepl("mp3", result$медиа, ignore.case = TRUE), 1, NA)
result$mp3[is.na(result$mp3)] <- 0

result$usb <- ifelse(grepl("usb", result$медиа, ignore.case = TRUE), 1, NA)
result$usb[is.na(result$usb)] <- 0

result$phone_installed <- ifelse(grepl("встроенный телефон", result$медиа, ignore.case = TRUE), 1, NA)
result$phone_installed[is.na(result$phone_installed)] <- 0

result$subwoofer <- ifelse(grepl("сабвуфер", result$медиа, ignore.case = TRUE), 1, NA)
result$subwoofer[is.na(result$subwoofer)] <- 0

##32 new vars were generated