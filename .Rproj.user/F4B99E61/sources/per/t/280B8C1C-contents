##  load library --------------------
library(rjson)
library(shinydashboard)
library(shinydashboardPlus)
library(shiny)
#library(plyr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(highcharter)
library(plotly)
library(lubridate)
library(stringr)
library(withr)
library(treemap)
library(DT)
library(shinyBS)
library(shinyjs)
library(WDI)
library(geosphere)
library(magrittr)
library(shinycssloaders)
options(spinner.color="#006272")
library(timevis)
#library(RCurl)
#library(jsonlite)
library(memoise)
library(networkD3)
library(promises)
library(future)
plan(multisession)
library("viridis")
library("geojsonio")
library("sf")
library(openxlsx)
library(RColorBrewer)
library(scales)
library(lattice)
library(leaflet)
library(leaflet.minicharts)
library(magrittr)
library(readxl)
library(shinythemes)
library(shinyWidgets)
library(bslib)
library(htmltools)
library(htmlwidgets)
library(shinymaterial)
library(randomForest)
library(caret)
library(e1071)
library(ranger)
library(forcats)
library(shinyjs)
library(shinycssloaders)

#source('helper_funs.R')


#load datasets
load("cars_dataset_full.rda")
load("train_data.rda")
rf_new_wtime_model_u30k_46_vars <- readRDS("rf_new_wtime_model_u30k_46_vars.rds")


load("e_notarius_avto.rda")

#load("G:/Meine Ablage/Data_solutions/Car market/data/df_car_market_org.rda")
#load("G:/.shortcut-targets-by-id/14JaIYOzGMSPz9fxk1BC73dzq4pbVmigd/Data_solutions/Car market/data/df_car_market_org.rda")

current_date <- Sys.Date()
current_month_year <- format(current_date, "%m-%Y")


binary_cols <- names(train_data)[sapply(train_data, function(x) all(x %in% c(0, 1)))]

ex_features <- c("vetrovik", "litium_discs", "kenguryatnik", "lyuk", "lebedka", "obves", "reyling", "spoyler", 
                 "tonirovka", "farkop")

optional_features <- c("abs", "автозапуск", "бесключевой_доступ", "бортовой_компьютер", "вентиляция_сидений", 
                       "гидравлика_руля", "датчик_давления_шинах", "датчик_дождя", "датчик_света", "зимний_режим", 
                       "изменяемый_клиренс", "камера_заднего_вида", "климат_контроль", "кондиционер", 
                       "круиз_контроль", "мультируль", "навигационная_система", "память_руля", "память_сидений", 
                       "парктроники", "пневмоподвеска", "подогрев_задних_сидений", "подогрев_руля", 
                       "подогрев_сидений", "подушка_безопасности", "полный_электропакет", "сигнализация", 
                       "спортивный_режим", "турбонаддув", "турботаймер", "центрозамок")

optics <- c("ksenon", "linsen", "window_heating", "blinker_washers", "protivotuman", "xrustal", "ogni", "light_corrector")

interior_features <- c("alcantara", "velure", "wood", "leather", "combi", "shtorki")

audio_options <- c("bluetooth", "disc_reader", "audio_system", "mp3", "usb", "phone_installed", "subwoofer")
